---
title: "Math 430: Lecture 2a"
subtitle: "Foundations for Statistical Inference"
author: "Professor Catalina Medina"
execute:
  echo: true
format: 
  revealjs:
    theme: [sky, ../slide-style.scss]
    slide-number: true
---

# Research process

```{r}
#| echo: false
#| fig-align: center
#| fig-out: 80%
#| fig-cap: "Image from <https://bookdown.org/pkaldunn/SRM-Textbook/Intro.html>"
knitr::include_graphics("img/research-steps.png")
```

## Research questions

Consider the following three research questions:

-   What is the average mercury content in swordfish in the Atlantic Ocean?
-   Do domestic cats live longer than domestic dogs on average?
-   Does a new drug reduce the number of deaths in patients with severe heart disease?

## Population

Each research question refers to a target **population**

-   What is the average mercury content in [swordfish in the Atlantic Ocean]{.underline}?
-   Do [domestic cats]{.underline} live longer than [domestic]{.underline} [dogs]{.underline} on average?
-   Does a new drug reduce the number of deaths in [patients with severe heart disease]{.underline}?

## Data

If we were able to collect data on everyone in our target population we would have a **census**

If we can only collect data on a proportion of the population we have a **sample**

## Parameter versus statistic

We want to understand something about the population, the **population parameter**

Since we can typically only obtain a sample, we use a **sample statistic** to infer about the population parameter

Example: What is the average mercury content in swordfish in the Atlantic Ocean?

Population parameter: Average mercury content in [all swordfish]{.underline} in the Atlantic Ocean ($\mu$)

Sample statistic: Average mercury content in [swordfish in our sample]{.underline} of fish from the Atlantic ($\bar{x}$)

## Sampling methods

We want the data in our sample to be as representative of our population as possible, to reduce bias

Recall $E[\bar{x}] - \mu$

**Bias** refers to any systematic misrepresentation of the target population or a parameter caused by the sampling or the study design.  

## Example

::: {.callout-tip icon=false}
## Do CSUCI students who exercise regularly have higher GPA?

Consider that we design a survey with the following questions to study the research question.

- Do you exercise at least once every week?

- What is your GPA?
::: 

## Convenience (Availability) Sampling

**Convenience sampling** occurs when a specific sample is selected because the sample is easy to access.

::: {.callout-tip icon=false}
## Example: Do CSUCI students who exercise regularly have higher GPA?

- Stand in front of the Broom library
- Give the survey to 100 CSUCI students
:::

This could introduce (sampling) bias and the findings may not generalize to the population. It is possible that those in front of the library

- may study more and thus may have higher GPA
- may be more active than those who study at home

## Simple random sample

We typically want a **simple random sample**. Meaning each case in the population has an equal chance of being included and the cases in the sample are not related to each other.

::: {.callout-tip icon=false}
## Example: Do CSUCI students who exercise regularly have higher GPA?

The researcher can
- reach out to the registrar to get student emails
- randomly select and email the survey to 100 students
:::

## Simple Random Sampling in R

```{r}
sample(1:100, size = 3, replace = FALSE)
```

This allows us to sample 3 numbers from 1 to 100 without replacement, meaning a number can only be selected once.

. . . 

To generalize:

```{r}
#| eval: false
sample(x = 1:N, size = n, replace = FALSE)
```

This code will take a random sample of size $n$ from the population consisting of the numbers in the interval $[1, N]$


## Non-response Bias

Even when simple random sampling is used, if participants are unwilling to participate in studies then the results can have **nonresponse bias**.

::: {.callout-tip icon=false}

## Example

It is unlikely that 100 students will respond. Assume that 86 respond. 

It is possible that those 14 who did not respond

- may be busy exercising and did not have the time to respond.
- may be busy studying and did not have the time to respond. 

:::

## Cluster Sampling 

In **cluster sampling** the population is divided into group (i.e, clusters). The sample consists of elements in randomly selected clusters. 

. . .

::: {.callout-tip icon=false}

## Example

The researchers may get a list of classes taught at CSUCI. They randomly select 10 classes. All the students in those 10 classes will be in the sample.

:::

## Stratified Sampling 

In stratified sampling the population is first divided into groups (i.e., stratas) and then the sample is selected randomly within each strata.

. . .

::: {.callout-tip icon=false}

## Example

The researchers suspect that exercising patterns might be different across different class years. Thus they want to make sure that the sample includes first-years, sophomores, juniors, and seniors. They get a list of students with class year information from the registrar. They then randomly select 25 students who are first years, 25 sophomores, 25 juniors, and 25 seniors.

:::

# Study design

## Observational Study

In **observational studies**, researchers study the research question without exposing the cases (or subset of a sample) to any treatment or intervention. In observational studies causal relationships between variables cannot be established.


::: {.callout-tip icon=false}

## Example

Based on the survey, even if we observe that CSUCI students who exercise regularly have higher GPA, we cannot conclude that exercising regularly increases GPA.

:::


## Relationship between two variables

If two variables are related to each other in some way we would call them __associated__.

If two variables are not related to each other in any way we would call them __independent__.



## Relationship between two variables

When we examine the relationship between two variables, we often want to know if the relationship between them is causal. In other words, does one variable cause the other? For instance, is exercising the reason for higher GPA? We don't know!

When we suspect that two variables have a causal relationship we can say

The __explanatory variable__ (e.g. exercising) might causally affect the __response variable__ (e.g. GPA).

. . .

Relationship between two variables does not imply one causes the other. 

## Relationship between two variables

Explanatory variables are denoted by $x$ and the response variable is denoted by $y$. 


##


```{r echo = FALSE, fig.align='center', out.width='50%'}
knitr::include_graphics("img/confounding.png")
```

A __confounding variable__ (e.g. time management skills) has a correlation with the the explanatory and the response variable.


## Experiment Design

In __experiments__, researchers assign cases to treatments/interventions.

. . .

In __randomized experiments__, researchers randomly assign cases  to treatments/interventions. In order to establish causal link between variables, we need randomized experiments. 

Randomization helps control for confounding, but is not always ethical.

##

::: {.callout-tip icon=false}

## Example 

~~Do CSUCI students who exercise regularly have higher GPA?~~

Does exercising regularly increase GPA for CSUCI students?

:::

##

::: {.callout-tip icon=false}

## Note

Random sampling and random assignment (i.e., random allocation) serve different purposes. 

:::{.nonincremental}

::::{.columns}

:::{.column width="50%"}



### Random sampling

- method of choosing sample from the population

- the goal is to establish generalizability


:::

:::{.column width="50%"}

### Random allocation

- method of assigning the sample to different treatment groups

- the goal is to establish causality.
:::

::::

:::

:::
